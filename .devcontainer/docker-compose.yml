version: '3'
services:
  opa:
    build:
      context: .
      dockerfile: Dockerfile
    init: true
    volumes:
      - ..:/workspace:cached
    environment:
      ENDPOINT_URL: http://dynamodb:8000/
      AWS_REGION: us-east-1
      AWS_ACCESS_KEY_ID: foo
      AWS_SECRET_ACCESS_KEY: bar
      TABLE_NAME: OpaDynamodbIntegrationTest
    depends_on:
      - dynamodb
    links:
      - dynamodb:dynamodb
    command: tail -f /dev/null
  dynamodb-admin:
    image: aaronshaf/dynamodb-admin
    environment:
      DYNAMO_ENDPOINT: http://dynamodb:8000
    depends_on:
      - dynamodb
    ports:
      - 8080:8001
  dynamodb:
    image: amazon/dynamodb-local
    command: -jar DynamoDBLocal.jar -sharedDb
